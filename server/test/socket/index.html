<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Socket test</title>
</head>

<body>
    <h1>Socket.io Testing</h1>
    <ul id="events"></ul>

    <input id='input'>
    <button id="btn" onclick="sendMsg()">Send</button>

    <script src="https://cdn.jsdelivr.net/npm/socket.io-client@2/dist/socket.io.js"></script>
    <script>
        const $event = document.getElementById('events');

        const $input = document.getElementById('input');

        const newItem = (content) => {
            const item = document.createElement('li');
            item.innerHTML = content;
            return item;
        }

        function startConnect() {
            // const socket = io('ws://127.0.0.1:7001/ws?token=123123');
            const socket = io('ws://tiktok.kingfish404.cn/ws?token=123123');

            socket.on('connect', () => {
                $event.appendChild(newItem('connect'));
                socket.send('123123');
            });

            socket.on('res', (res) => {
                $event.appendChild(newItem(res));
            });

            window.socket = socket;
        }

        function sendMsg() {
            const msg = $input.value;
            console.log(msg);
            window.socket.emit('chat', { name: 12313 });
        }

        startConnect();
    </script>
</body>

</html>